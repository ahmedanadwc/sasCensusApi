<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- HTML header for doxygen 1.8.17-->
<html xmlns="https://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.6" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>sasCensusApi: code/macros/censusapi/censusapi_getalldatasets.sas Source File</title>
    <meta name="description" content="Custom built SAS macro programs to extract data from the public Census Data API. These out of the box custom built SAS macro programs atreamline data acquisition and manipulation. They use the metadata supplied by the Census Data API registration to dynamically derive column type conversion and label assignments. As a minimum, Base SAS® Software, version 9.4 Maintenance 4 installation is required to run these macros." />
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link href="new_stylesheet.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="top">
      <!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr style="height: 56px">
              <td id="projectlogo">
                <a href=""
                  ><img alt="Logo" src="logo.png"
                /></a>
              </td>
              <td id="projectalign" style="padding-left: 0.5em">
                <div id="projectname">sasCensusApi</div>
                <div id="projectbrief">Custom built SAS macro programs to extract data from the public Census Data API. These out of the box custom built SAS macro programs atreamline data acquisition and manipulation. They use the metadata supplied by the Census Data API registration to dynamically derive column type conversion and label assignments. As a minimum, Base SAS® Software, version 9.4 Maintenance 4 installation is required to run these macros.</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
    </div>
  </body>
</html>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('censusapi__getalldatasets_8sas_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">censusapi_getalldatasets.sas</div></div>
</div><!--header-->
<div class="contents">
<a href="censusapi__getalldatasets_8sas.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/**</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">  @file censusapi_getalldatasets.sas</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">  @brief Parses the Data sets Metadata stored in the specified data.json file</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">  @details</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">  Parses the Data sets Metadata stored in the specified data.json file into SAS </span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">  Data Set and generate an Excel workbook, using PROC HTTP and JSON Library engine.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"></span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">      Usage Example:</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">      %censusapi_getalldatasets(p_outLibName=APILIB</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">      , p_outDsName=_api_all_data</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">      , p_dataJsonURL=%str(https://api.census.gov/data.json)</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">      , p_reportOutputPath=&amp;g_outputRoot)</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"></span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">  @param [in] p_outLibName= The output Library name. Default:APILIB. Required</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment">  @param [in] p_outDsName= The output data set name. Default:_api_all_data. Required</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment">  @param [in] p_dataJsonURL= The Data API Data JSON File. Default:https://api.census.gov/data.json. Required</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">  @param [in] p_reportOutputPath= The output pathname. Default:&amp;g_outputRoot. Required</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"></span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment">  &lt;h4&gt; SAS Macros &lt;/h4&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">  @li etl_shrinkmydata.sas</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"></span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">  @version SAS 9.4</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">  @author Ahmed Al-Attar</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment"></span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment">**/</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>%MACRO censusapi_getAllDataSets(p_outLibName=APILIB</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>, p_outDsName=_api_all_data</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>, p_dataJsonURL=%str(https:<span class="comment">//api.census.gov/data.json)</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>, p_reportOutputPath=&amp;g_outputRoot);</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>  %LOCAL</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>    l_sTime</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>    l_eTime</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>    l_rTime</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    l_rc</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>    l_msg</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    ;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  %LOCAL </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    l_libRef</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    l_outDsName;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  * Record Starting Time;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  %let l_sTime = %sysfunc(time());</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment">  /********** BEGIN -- Macro Parameter Validation **********/</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  %<span class="keywordflow">if</span> (%superq(p_outLibName) EQ ) %then</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  %<span class="keywordflow">do</span>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="comment">/* Missing p_outLibName value in macro call */</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    %let l_rc  = 1;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    %let l_msg = ERROR: censusapi_getAllDataSets: p_outLibName is invalid. Please specify non-missing value;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    %<span class="keywordflow">goto</span> exit;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  %end;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  %<span class="keywordflow">if</span> (%superq(p_outDsName) EQ ) %then</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  %<span class="keywordflow">do</span>;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="comment">/* Missing p_outDsName value in macro call */</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    %let l_rc  = 2;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    %let l_msg = ERROR: censusapi_getAllDataSets: p_outDsName is invalid. Please specify non-missing value;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    %<span class="keywordflow">goto</span> exit;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  %end;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  %<span class="keywordflow">if</span> (%superq(p_dataJsonURL) EQ ) %then</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>  %<span class="keywordflow">do</span>;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="comment">/* Missing p_dataJsonURL value in macro call */</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    %let l_rc  = 3;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    %let l_msg = ERROR: censusapi_getAllDataSets: p_dataJsonURL is invalid. Please specify non-missing value;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    %<span class="keywordflow">goto</span> exit;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  %end;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  %<span class="keywordflow">if</span> (%superq(p_reportOutputPath) EQ ) %then</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  %<span class="keywordflow">do</span>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    <span class="comment">/* Missing p_reportOutputPath value in macro call */</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    %let l_rc  = 4;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    %let l_msg = ERROR: censusapi_getAllDataSets: p_reportOutputPath is invalid. Please specify non-missing value;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    %<span class="keywordflow">goto</span> exit;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  %end;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="comment">  /********** END -- Macro Parameter Validation **********/</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  %let l_libref= apidslib;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  <span class="comment">/* Access the Census Data API Registered Data/Tables via JSON */</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  FILENAME apijsonf TEMP;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  PROC HTTP</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    METHOD=<span class="stringliteral">&quot;GET&quot;</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    URL=<span class="stringliteral">&quot;&amp;p_dataJsonURL&quot;</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    OUT=apijsonf;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    SYSECHO <span class="stringliteral">&quot;Requesting the Data JSON URL via Proc HTTP&quot;</span>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  RUN;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  <span class="comment">/* Use SAS JSON Library Engine */</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  LIBNAME &amp;l_libref JSON FILEREF=apijsonf;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  <span class="comment">/* Create a temporary yn. format */</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  PROC FORMAT lib=work;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    value yn </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      1 = <span class="charliteral">&#39;y&#39;</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>      other = <span class="charliteral">&#39;n&#39;</span>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    value vintage </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      . = <span class="stringliteral">&#39;NA&#39;</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      other = [best.];</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  RUN;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  <span class="comment">/* Create consolidated datasets reporting list */</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  DATA &amp;p_outLibName..&amp;p_outDsName(DROP=c_is: trailText RENAME=(ordinal_dataset=_ROWID_));</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    SYSECHO <span class="stringliteral">&quot;Processing the returned JSON response and generating the &amp;p_outLibName..&amp;p_outDsName output data set&quot;</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keywordflow">if</span> (0) then SET &amp;l_libref..DATASET_C_DATASET(KEEP=ordinal_dataset c_dataset:);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    LENGTH</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      c_geographyLink_html c_variablesLink_html c_examplesLink_html c_groupsLink_html BaseURL $200;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    LENGTH ds_unique_id $25 trailText $13;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    FORMAT ordinal_dataset BEST8.;</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    SET &amp;l_libref..DATASET(DROP=ordinal_root _type accesslevel temporal identifier license</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                  c_documentationlink c_tagsLink c_sorts_url c_valuesLink);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    LENGTH</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>      Aggregate_i Cube_i Available_i Timeseries_i Microdata_i $1;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    FORMAT c_vintage vintage.;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="keywordflow">if</span> (_n_=1) then</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="keywordflow">do</span>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      dcl hash h (dataset:<span class="stringliteral">&quot;&amp;l_libref..DATASET_C_DATASET(KEEP=ordinal_dataset c_dataset:)&quot;</span>);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>      h.defineKey(<span class="stringliteral">&#39;ordinal_dataset&#39;</span>);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>      h.defineData(all:<span class="stringliteral">&#39;yes&#39;</span>);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>      h.defineDone();</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    end;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="comment">/* Get Dataset Name Hierarchy columns */</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    _iorc_ = h.find();</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="comment">/* Convert Numeric Indicators to Single Y/N Char */</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    Aggregate_i  = PUT(c_isAggregate,yn.);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    Cube_i       = PUT(c_isCube,yn.);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    Available_i  = PUT(c_isAvailable,yn.);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    Timeseries_i = PUT(c_isTimeseries,yn.);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    Microdata_i  = PUT(c_isMicrodata,yn.);</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="comment">/* Change the values to represent HTML links */</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    c_geographyLink_html = TRANWRD(STRIP(c_geographyLink),<span class="stringliteral">&#39;json&#39;</span>,<span class="stringliteral">&#39;html&#39;</span>);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    c_variablesLink_html = TRANWRD(STRIP(c_variablesLink),<span class="stringliteral">&#39;json&#39;</span>,<span class="stringliteral">&#39;html&#39;</span>);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    c_examplesLink_html  = TRANWRD(STRIP(c_examplesLink),<span class="stringliteral">&#39;json&#39;</span>,<span class="stringliteral">&#39;html&#39;</span>);</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    c_groupsLink_html  = TRANWRD(STRIP(c_groupsLink),<span class="stringliteral">&#39;json&#39;</span>,<span class="stringliteral">&#39;html&#39;</span>);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    ds_unique_id     = <span class="charliteral">&#39;_&#39;</span> || STRIP(CATX(<span class="charliteral">&#39;_&#39;</span>,ordinal_dataset,c_dataset1,PUT(c_vintage,vintage.)));</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>    trailText = SCAN(c_examplesLink_html,-1,<span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    BaseURL = STRIP(TRANWRD(c_examplesLink_html,STRIP(trailText),<span class="charliteral">&#39; &#39;</span>));</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    LABEL</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      ordinal_dataset = <span class="stringliteral">&#39;Dataset _ROWID_&#39;</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      ds_unique_id  = <span class="stringliteral">&#39;Dataset Uniqe ID&#39;</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      c_dataset1    = <span class="stringliteral">&#39;Dataset Name - Level 1&#39;</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      c_dataset2    = <span class="stringliteral">&#39;Dataset Name - Level 2&#39;</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>      c_dataset3    = <span class="stringliteral">&#39;Dataset Name - Level 3&#39;</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      c_dataset4    = <span class="stringliteral">&#39;Dataset Name - Level 4&#39;</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>      title     = <span class="stringliteral">&#39;Title&#39;</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>      description   = <span class="stringliteral">&#39;Description&#39;</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>      c_vintage   = <span class="stringliteral">&#39;Vintage&#39;</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>      c_geographyLink = <span class="stringliteral">&#39;Geography list (JSON)&#39;</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      c_variablesLink = <span class="stringliteral">&#39;Variable list (JSON)&#39;</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>      c_groupsLink    = <span class="stringliteral">&#39;Group list (JSON)&#39;</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>      Aggregate_i   = <span class="stringliteral">&#39;Aggregate indicator&#39;</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      Cube_i      = <span class="stringliteral">&#39;Cube indicator&#39;</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>      Available_i   = <span class="stringliteral">&#39;Available indicator&#39;</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      modified    = <span class="stringliteral">&#39;Modification Date Time&#39;</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      c_examplesLink  = <span class="stringliteral">&#39;Examples list (JSON)&#39;</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>      spatial     = <span class="stringliteral">&#39;Spatial level&#39;</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>      Timeseries_i  = <span class="stringliteral">&#39;Timeseries indicator&#39;</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>      Microdata_i   = <span class="stringliteral">&#39;Microdata indicator&#39;</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      c_geographyLink_html = <span class="stringliteral">&#39;Geography list (HTML)&#39;</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      c_variablesLink_html = <span class="stringliteral">&#39;Variable list (HTML)&#39;</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      c_examplesLink_html = <span class="stringliteral">&#39;Examples list (HTML)&#39;</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      c_groupsLink_html = <span class="stringliteral">&#39;Group list (HTML)&#39;</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      BaseURL           = <span class="stringliteral">&#39;Base URL&#39;</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>      ;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  RUN;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>  %let l_outDsName = &amp;p_outLibName..&amp;p_outDsName;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  SYSECHO <span class="stringliteral">&quot;Shrinking the &amp;p_outLibName..&amp;p_outDsName data set&quot;</span>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  %etl_shrinkMyData(p_inDsName=&amp;l_outDsName, p_outDsName=&amp;l_outDsName)</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="comment">/* Create unique index on the BaseURL column */</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  PROC DATASETS LIB=&amp;p_outLibName NOLIST; </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    MODIFY &amp;p_outDsName;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    INDEX CREATE BaseURL / NOMISS UNIQUE;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  QUIT;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <span class="comment">/* Display the Result in Excel Workbook */</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  TITLE <span class="stringliteral">&quot;List of all available tables by the Census Data API as of %SYSFUNC(datetime(),datetime20.) &quot;</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>  SYSECHO <span class="stringliteral">&quot;Generating the interactive Excel Workbook for the &amp;p_outLibName..&amp;p_outDsName output data set&quot;</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  ODS EXCEL file=<span class="stringliteral">&quot;&amp;g_outputRoot.&amp;g_slash.api_all_data.xlsx&quot;</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      options(embedded_titles = <span class="stringliteral">&quot;on&quot;</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        embedded_footnotes=<span class="stringliteral">&quot;on&quot;</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        frozen_headers = <span class="stringliteral">&quot;on&quot;</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        sheet_name=<span class="stringliteral">&quot;&amp;p_outDsName&quot;</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        start_at=<span class="stringliteral">&quot;2,2&quot;</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        flow=<span class="stringliteral">&quot;tables&quot;</span>)</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    style=styles.SNOW ;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    PROC PRINT DATA=&amp;p_outLibName..&amp;p_outDsName LABEL NOOBS;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>      VAR _ROWID_ ds_unique_id</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>        title description c_vintage Aggregate_i Cube_i Available_i </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        spatial Timeseries_i Microdata_i modified c_geographyLink_html </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        c_variablesLink_html c_groupsLink_html c_examplesLink_html;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    RUN;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  ODS EXCEL CLOSE;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  TITLE; FOOTNOTE;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  %goto finished;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  %exit:</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    %PUT *** ERROR: censusapi_getAllDataSets  ***;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    %PUT *** l_RC must be zero (0).   ***;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    %PUT *** l_RC= &amp;l_RC    .         ***;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    %PUT *** &amp;l_MSG ***;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    %PUT *** ERROR: censusapi_getAllDataSets  ***;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  %finished:</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="comment">/* --- Clean up --- */</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    LIBNAME &amp;l_libref CLEAR;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    FILENAME apijsonf;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    %let l_eTime=%sysfunc(time());</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    %let l_rTime=%sysfunc(putn(%sysevalf(&amp;l_eTime - &amp;l_sTime),time12.2));</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    %PUT &gt;&gt;&gt; censusapi_getAllDataSets :&gt;&gt;&gt; Total RunTime = &amp;l_rTime;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    ;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>%MEND censusapi_getAllDataSets;</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath">
  <!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_050edd66366d13764f98250ef6db77f6.html">code</a></li><li class="navelem"><a class="el" href="dir_8299b97efaa0c531d43464ca9378858c.html">macros</a></li><li class="navelem"><a class="el" href="dir_942055c7697e45f0aca7cdcdb7ab5a03.html">censusapi</a></li><li class="navelem"><a class="el" href="censusapi__getalldatasets_8sas.html">censusapi_getalldatasets.sas</a></li>
    <li class="footer">
      Generated by
      <a href="https://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.svg" alt="doxygen"
      /></a>
      1.9.6
    </li>
    <li>
      <i> For more information visit the </i>
      <a href="https://cli.sasjs.io">SASjs cli</a> documentation.
    </li>
  </ul>
</div>
